{%- comment -%}
  Simple Bootstrap navbar driven by _data/nav.yml
  Optional: set site.logo (path/URL) in _config.yml
{%- endcomment -%}

<header class="navbar navbar-expand-lg fixed-top" data-bs-theme="light">
  <div class="container">

    <!-- Brand -->
    <a class="navbar-brand pe-sm-3" href="{{ '/' | relative_url }}">
      {%- if site.logo -%}
        <img src="{{ site.logo | relative_url }}" class="img-fluid w-50" alt="{{ site.title | escape }}">
      {%- else -%}
        {{ site.title }}
      {%- endif -%}
    </a>

    <!-- Mobile toggler -->
    <button class="navbar-toggler ms-sm-3" type="button"
            data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-label="Toggle navigation" aria-controls="navbarNav" aria-expanded="false">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Links -->
    <nav class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav navbar-nav-scroll ms-auto" style="--ar-scroll-height: 520px;">

        {%- assign current = page.url | replace: 'index.html','' -%}
        {%- for item in site.data.nav -%}
          {%- assign href = item.url | default: '#' -%}
          {%- assign href_norm = href | append: '' -%}
          {%- comment -%}
            Active state:
            - exact match
            - or current starts with href (for section roots like /about/)
          {%- endcomment -%}
          {%- assign is_active = false -%}
          {%- if current == href or current == href | append: '/' -%}
            {%- assign is_active = true -%}
          {%- elsif href != '/' and current != '/' and current contains href -%}
            {%- assign is_active = true -%}
          {%- endif -%}

          <li class="nav-item">
            <a class="nav-link{% if is_active %} active{% endif %}"
               href="{{ href | relative_url }}">
              {{ item.name }}
            </a>
          </li>
        {%- endfor -%}

      </ul>
    </nav>
  </div>
</header>
